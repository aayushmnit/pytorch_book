<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.226">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>The PyTorch Book - 2&nbsp; Tensors</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../basics/0_pytorch_intro.html" rel="prev">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>


</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Tensors</span></h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../">The PyTorch Book</a> 
        <div class="sidebar-tools-main">
    <a href="" title="Share" id="sidebar-tool-dropdown-0" class="sidebar-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi bi-share"></i></a>
    <ul class="dropdown-menu" aria-labelledby="sidebar-tool-dropdown-0">
        <li>
          <a class="dropdown-item sidebar-tools-main-item" href="https://www.linkedin.com/sharing/share-offsite/?url=|url|">
            <i class="bi bi-bi-linkedin pe-1"></i>
          LinkedIn
          </a>
        </li>
        <li>
          <a class="dropdown-item sidebar-tools-main-item" href="https://twitter.com/intent/tweet?url=|url|">
            <i class="bi bi-bi-twitter pe-1"></i>
          Twitter
          </a>
        </li>
        <li>
          <a class="dropdown-item sidebar-tools-main-item" href="https://www.facebook.com/sharer/sharer.php?u=|url|">
            <i class="bi bi-bi-facebook pe-1"></i>
          Facebook
          </a>
        </li>
    </ul>
  <a href="" class="quarto-color-scheme-toggle sidebar-tool" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
    </div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">Preface</a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">PyTorch basics</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../basics/0_pytorch_intro.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">PyTorch Introduction and Installation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../basics/1_pytorch_tensors.html" class="sidebar-item-text sidebar-link active"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Tensors</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#what-are-tensors" id="toc-what-are-tensors" class="nav-link active" data-scroll-target="#what-are-tensors"><span class="toc-section-number">2.1</span>  What are Tensors?</a></li>
  <li><a href="#initializing-a-tensor" id="toc-initializing-a-tensor" class="nav-link" data-scroll-target="#initializing-a-tensor"><span class="toc-section-number">2.2</span>  Initializing a Tensor</a></li>
  <li><a href="#tensor-attributes" id="toc-tensor-attributes" class="nav-link" data-scroll-target="#tensor-attributes"><span class="toc-section-number">2.3</span>  Tensor Attributes</a></li>
  <li><a href="#tensor-operations" id="toc-tensor-operations" class="nav-link" data-scroll-target="#tensor-operations"><span class="toc-section-number">2.4</span>  Tensor Operations</a>
  <ul class="collapse">
  <li><a href="#moving-tensor-from-cpu-to-gpu" id="toc-moving-tensor-from-cpu-to-gpu" class="nav-link" data-scroll-target="#moving-tensor-from-cpu-to-gpu"><span class="toc-section-number">2.4.1</span>  Moving tensor from CPU to GPU</a></li>
  <li><a href="#slicing-and-indexing" id="toc-slicing-and-indexing" class="nav-link" data-scroll-target="#slicing-and-indexing"><span class="toc-section-number">2.4.2</span>  Slicing and Indexing</a></li>
  <li><a href="#concatenation" id="toc-concatenation" class="nav-link" data-scroll-target="#concatenation"><span class="toc-section-number">2.4.3</span>  Concatenation</a></li>
  <li><a href="#arithmetic-operations" id="toc-arithmetic-operations" class="nav-link" data-scroll-target="#arithmetic-operations"><span class="toc-section-number">2.4.4</span>  Arithmetic operations</a></li>
  </ul></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references"><span class="toc-section-number">2.5</span>  References</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title d-none d-lg-block"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Tensors</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<section id="what-are-tensors" class="level2" data-number="2.1">
<h2 data-number="2.1" class="anchored" data-anchor-id="what-are-tensors"><span class="header-section-number">2.1</span> What are Tensors?</h2>
<p>PyTorch provides tensors as its primary data structure. Tensors are similar to numpy arrays, but they can be used on a GPU to accelerate the computation. PyTorch tensors are similar to numpy arrays, but they have additional functionality (automatic differentiation) and are designed to take advantage of GPUs for acceleration. Similar to numpy, tensors in PyTorch supports a variety of operations, including indexing, slicing, math operations, linear algebra operations, and more. Let’s dive in by importing the library.</p>
<div class="cell" data-executetime="{&quot;end_time&quot;:&quot;2022-12-26T19:30:40.998020Z&quot;,&quot;start_time&quot;:&quot;2022-12-26T19:30:40.297313Z&quot;}" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> torch</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="initializing-a-tensor" class="level2" data-number="2.2">
<h2 data-number="2.2" class="anchored" data-anchor-id="initializing-a-tensor"><span class="header-section-number">2.2</span> Initializing a Tensor</h2>
<p>There are several ways to initialize tensors in PyTorch. Here are some examples:</p>
<p><strong>Initializing from an iterator like a list</strong></p>
<div class="cell" data-executetime="{&quot;end_time&quot;:&quot;2022-12-25T19:47:03.640369Z&quot;,&quot;start_time&quot;:&quot;2022-12-25T19:47:03.636990Z&quot;}" data-execution_count="8">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Initialize a tensor from a list</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>tensor_from_list <span class="op">=</span> torch.tensor([<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>])</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Tensor from list: </span><span class="ch">\n</span><span class="st">"</span>, tensor_from_list)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Initialize a tensor from a nested list</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>tensor_from_nested_list <span class="op">=</span> torch.tensor([[<span class="dv">1</span>, <span class="dv">2</span>], [<span class="dv">3</span>, <span class="dv">4</span>]])</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Tensor from nested list: </span><span class="ch">\n</span><span class="st">"</span>, tensor_from_nested_list)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Tensor from list: 
 tensor([1, 2, 3, 4])
Tensor from nested list: 
 tensor([[1, 2],
        [3, 4]])</code></pre>
</div>
</div>
<p><strong>Initializing from a numpy array</strong></p>
<div class="cell" data-executetime="{&quot;end_time&quot;:&quot;2022-12-25T19:47:58.479436Z&quot;,&quot;start_time&quot;:&quot;2022-12-25T19:47:58.476329Z&quot;}" data-execution_count="9">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a NumPy array</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>numpy_array <span class="op">=</span> np.array([[<span class="dv">1</span>, <span class="dv">2</span>], [<span class="dv">3</span>, <span class="dv">4</span>]])</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Initialize a tensor from a NumPy array</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>tensor_from_numpy <span class="op">=</span> torch.from_numpy(numpy_array)</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Tensor from np array: </span><span class="ch">\n</span><span class="st">"</span>, tensor_from_numpy)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Tensor from np array: 
 tensor([[1, 2],
        [3, 4]])</code></pre>
</div>
</div>
<p><strong>Initializing from another tensor</strong></p>
<div class="cell" data-executetime="{&quot;end_time&quot;:&quot;2022-12-25T19:49:19.939197Z&quot;,&quot;start_time&quot;:&quot;2022-12-25T19:49:19.935406Z&quot;}" data-execution_count="13">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a tensor</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>original_tensor <span class="op">=</span> torch.tensor([<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>])</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Initialize a new tensor from the original tensor</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>new_tensor <span class="op">=</span> original_tensor.clone()</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Tensor from another tensor: </span><span class="ch">\n</span><span class="st">"</span>, new_tensor)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Tensor from another tensor: 
 tensor([1, 2, 3, 4])</code></pre>
</div>
</div>
<p><strong>Constant or random initialization</strong></p>
<div class="cell" data-executetime="{&quot;end_time&quot;:&quot;2022-12-25T19:52:24.593920Z&quot;,&quot;start_time&quot;:&quot;2022-12-25T19:52:24.589406Z&quot;}" data-execution_count="15">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Initialize a tensor with all elements set to zero</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>tensor_zeros <span class="op">=</span> torch.zeros(<span class="dv">3</span>, <span class="dv">4</span>)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Tensor with all elements set to zero: </span><span class="ch">\n</span><span class="st">"</span>, tensor_zeros)</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Initialize a tensor with all elements set to one</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>tensor_ones <span class="op">=</span> torch.ones(<span class="dv">3</span>, <span class="dv">4</span>)</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st"> Tensor with all elements set to one: </span><span class="ch">\n</span><span class="st">"</span>, tensor_ones)</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Initialize a tensor with all elements set to a specific value</span></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>tensor_full <span class="op">=</span> torch.full((<span class="dv">3</span>, <span class="dv">4</span>), fill_value<span class="op">=</span><span class="fl">2.5</span>)</span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st"> Tensor with all elements set to a specific value: </span><span class="ch">\n</span><span class="st">"</span>, tensor_full)</span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Initialize a tensor with random values</span></span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>tensor_rand <span class="op">=</span> torch.rand(<span class="dv">3</span>, <span class="dv">4</span>)</span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st"> Tensor with random initialization: </span><span class="ch">\n</span><span class="st">"</span>, tensor_rand)</span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Initialize a tensor with random values from a normal distribution</span></span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a>tensor_randn <span class="op">=</span> torch.randn(<span class="dv">3</span>, <span class="dv">4</span>)</span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st"> Tensor with random values from a normal distribution: </span><span class="ch">\n</span><span class="st">"</span>, tensor_randn)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Tensor with all elements set to zero: 
 tensor([[0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.]])

 Tensor with all elements set to one: 
 tensor([[1., 1., 1., 1.],
        [1., 1., 1., 1.],
        [1., 1., 1., 1.]])

 Tensor with all elements set to a specific value: 
 tensor([[2.5000, 2.5000, 2.5000, 2.5000],
        [2.5000, 2.5000, 2.5000, 2.5000],
        [2.5000, 2.5000, 2.5000, 2.5000]])

 Tensor with random initialization: 
 tensor([[0.8675, 0.0161, 0.5472, 0.7002],
        [0.6551, 0.3049, 0.4088, 0.6341],
        [0.2363, 0.8951, 0.0335, 0.5779]])

 Tensor with random values from a normal distribution: 
 tensor([[ 1.0550,  0.9214, -1.3023,  0.4119],
        [-0.4691,  0.8733,  0.7910, -2.3932],
        [-0.6304, -0.8792,  0.4188,  0.4221]])</code></pre>
</div>
</div>
</section>
<section id="tensor-attributes" class="level2" data-number="2.3">
<h2 data-number="2.3" class="anchored" data-anchor-id="tensor-attributes"><span class="header-section-number">2.3</span> Tensor Attributes</h2>
<p>It has several attributes that you can access to get information about the tensor. Here are some common attributes of a PyTorch tensor:</p>
<ul>
<li><code>shape</code>: returns the shape of the tensor as a tuple of integers. For example, if the tensor has dimensions (batch_size, num_channels, height, width), the shape would be (batch_size, num_channels, height, width).</li>
<li><code>dtype</code>: returns the data type of the tensor. For example, the data type could be torch.float32 or torch.int64.</li>
<li><code>device</code>: returns the device on which the tensor is stored. This can be the CPU or a GPU.</li>
<li><code>requires_grad</code>: a boolean flag indicating whether the tensor requires gradient computation. If set to True, the tensor’s gradients will be computed during backpropagation.</li>
<li><code>grad</code>: a tensor containing the gradient of the tensor with respect to some scalar value. This attribute is typically used during training with gradient descent.</li>
</ul>
<p>You can access these attributes by calling them on a tensor object. For example:</p>
<div class="cell" data-executetime="{&quot;end_time&quot;:&quot;2022-12-25T20:40:38.985981Z&quot;,&quot;start_time&quot;:&quot;2022-12-25T20:40:38.982978Z&quot;}" data-execution_count="20">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>tensor_randn <span class="op">=</span> torch.randn(<span class="dv">3</span>, <span class="dv">4</span>)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Shape of tensor : </span><span class="sc">{</span>tensor_randn<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Type of tensor : </span><span class="sc">{</span>tensor_randn<span class="sc">.</span>dtype<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Device tensor is stored on : </span><span class="sc">{</span>tensor_randn<span class="sc">.</span>device<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Autograd enabled : </span><span class="sc">{</span>tensor_randn<span class="sc">.</span>requires_grad<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Any stored gradient : </span><span class="sc">{</span>tensor_randn<span class="sc">.</span>grad<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Shape of tensor : torch.Size([3, 4])
Type of tensor : torch.float32
Device tensor is stored on : cpu
Autograd enabled : False
Any stored gradient : None</code></pre>
</div>
</div>
<p>As we can see above we initialized a random tensor of shape (3,4) with a torch.float32 data type and its currently on a cpu device. Currently, automatic gradient calculations are disabled and no gradient is stored in the tensor.</p>
<p>There are several other attributes that you can access, such as <code>ndim</code>, <code>size</code>, <code>numel</code>, <code>storage</code>, etc. You can find more information about these attributes in the <a href="https://pytorch.org/docs/stable/tensors.html">PyTorch Tensor documentation</a>.</p>
</section>
<section id="tensor-operations" class="level2" data-number="2.4">
<h2 data-number="2.4" class="anchored" data-anchor-id="tensor-operations"><span class="header-section-number">2.4</span> Tensor Operations</h2>
<p>There are several operations you can perform on tensors, lets look at the most commonly used operations.</p>
<section id="moving-tensor-from-cpu-to-gpu" class="level3" data-number="2.4.1">
<h3 data-number="2.4.1" class="anchored" data-anchor-id="moving-tensor-from-cpu-to-gpu"><span class="header-section-number">2.4.1</span> Moving tensor from CPU to GPU</h3>
<p>To move a tensor from CPU to GPU is a simple command but probably the one which people will use the most.</p>
<div class="cell" data-executetime="{&quot;end_time&quot;:&quot;2022-12-25T22:34:30.481106Z&quot;,&quot;start_time&quot;:&quot;2022-12-25T22:34:30.457389Z&quot;}" data-execution_count="23">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>tensor_randn.to(<span class="st">"cuda"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="23">
<pre><code>tensor([[-0.0984, -1.3804,  0.3343, -0.1623],
        [ 0.9155, -0.8620, -0.3943, -0.2997],
        [-0.1336, -0.7395, -0.7143, -0.0735]], device='cuda:0')</code></pre>
</div>
</div>
<p>As we can see the tensor_randn is now moved to a cuda(GPU) device.</p>
</section>
<section id="slicing-and-indexing" class="level3" data-number="2.4.2">
<h3 data-number="2.4.2" class="anchored" data-anchor-id="slicing-and-indexing"><span class="header-section-number">2.4.2</span> Slicing and Indexing</h3>
<p>PyTorch tensors similar to numpy arrays support various slicing and indexing operations.</p>
<div class="cell" data-executetime="{&quot;end_time&quot;:&quot;2022-12-25T22:43:25.713911Z&quot;,&quot;start_time&quot;:&quot;2022-12-25T22:43:25.709184Z&quot;}" data-execution_count="38">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>tensor_randn <span class="op">=</span> torch.randn(<span class="dv">3</span>, <span class="dv">4</span>)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>tensor_randn</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="38">
<pre><code>tensor([[-1.3470,  0.2204,  0.2963, -0.9745],
        [ 0.1867, -1.8338, -1.1872, -1.2987],
        [ 0.0517, -0.3206,  0.3584, -0.4778]])</code></pre>
</div>
</div>
<div class="cell" data-executetime="{&quot;end_time&quot;:&quot;2022-12-25T22:43:26.415622Z&quot;,&quot;start_time&quot;:&quot;2022-12-25T22:43:26.411369Z&quot;}" data-execution_count="39">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"First row:  </span><span class="ch">\n</span><span class="sc">{</span>tensor_randn[<span class="dv">0</span>]<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss"> First column: </span><span class="ch">\n</span><span class="ss"> </span><span class="sc">{</span>tensor_randn[:, <span class="dv">0</span>]<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss"> Last column: </span><span class="sc">{</span>tensor_randn[..., <span class="op">-</span><span class="dv">1</span>]<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss"> Selected columns: </span><span class="ch">\n</span><span class="ss"> </span><span class="sc">{</span>tensor_randn[:,<span class="dv">2</span>:<span class="dv">4</span>]<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a><span class="co">## Assignment of column to zero</span></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>tensor_randn[:,<span class="dv">1</span>] <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st"> Assigning column to zero: </span><span class="ch">\n</span><span class="st">"</span>, tensor_randn)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>First row:  
tensor([-1.3470,  0.2204,  0.2963, -0.9745])

 First column: 
 tensor([-1.3470,  0.1867,  0.0517])

 Last column: tensor([-0.9745, -1.2987, -0.4778])

 Selected columns: 
 tensor([[ 0.2963, -0.9745],
        [-1.1872, -1.2987],
        [ 0.3584, -0.4778]])

 Assigning column to zero: 
 tensor([[-1.3470,  0.0000,  0.2963, -0.9745],
        [ 0.1867,  0.0000, -1.1872, -1.2987],
        [ 0.0517,  0.0000,  0.3584, -0.4778]])</code></pre>
</div>
</div>
</section>
<section id="concatenation" class="level3" data-number="2.4.3">
<h3 data-number="2.4.3" class="anchored" data-anchor-id="concatenation"><span class="header-section-number">2.4.3</span> Concatenation</h3>
<p>The <code>torch.cat</code> function can be used to concatenate or join multiple tensors together, which is often useful when working with deep learning models.</p>
<p>Let’s take our previous defined tensors and check their shape.</p>
<div class="cell" data-executetime="{&quot;end_time&quot;:&quot;2022-12-25T22:51:05.329440Z&quot;,&quot;start_time&quot;:&quot;2022-12-25T22:51:05.326348Z&quot;}" data-execution_count="42">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>tensor_ones.shape, tensor_zeros.shape, tensor_rand.shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="42">
<pre><code>(torch.Size([3, 4]), torch.Size([3, 4]), torch.Size([3, 4]))</code></pre>
</div>
</div>
<p>We can concatenate these tensors column wise by using <code>torch.cat</code> with <code>dim=1</code>. We will get a resultant tensor with shape (3,12).</p>
<div class="cell" data-executetime="{&quot;end_time&quot;:&quot;2022-12-25T22:51:30.836022Z&quot;,&quot;start_time&quot;:&quot;2022-12-25T22:51:30.831533Z&quot;}" data-execution_count="44">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>concat_tensor <span class="op">=</span> torch.cat([tensor_ones, tensor_zeros, tensor_rand], dim<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(concat_tensor.shape)</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>concat_tensor</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>torch.Size([3, 12])</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="44">
<pre><code>tensor([[1.0000, 1.0000, 1.0000, 1.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.8675,
         0.0161, 0.5472, 0.7002],
        [1.0000, 1.0000, 1.0000, 1.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.6551,
         0.3049, 0.4088, 0.6341],
        [1.0000, 1.0000, 1.0000, 1.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.2363,
         0.8951, 0.0335, 0.5779]])</code></pre>
</div>
</div>
<p>We can concatenate these tensors row wise by using <code>torch.cat</code> with <code>dim=0</code>. We will get a resultant tensor with shape (9,4).</p>
<div class="cell" data-executetime="{&quot;end_time&quot;:&quot;2022-12-25T22:51:40.750201Z&quot;,&quot;start_time&quot;:&quot;2022-12-25T22:51:40.746284Z&quot;}" data-execution_count="45">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>concat_tensor <span class="op">=</span> torch.cat([tensor_ones, tensor_zeros, tensor_rand], dim<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(concat_tensor.shape)</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>concat_tensor</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>torch.Size([9, 4])</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="45">
<pre><code>tensor([[1.0000, 1.0000, 1.0000, 1.0000],
        [1.0000, 1.0000, 1.0000, 1.0000],
        [1.0000, 1.0000, 1.0000, 1.0000],
        [0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000],
        [0.8675, 0.0161, 0.5472, 0.7002],
        [0.6551, 0.3049, 0.4088, 0.6341],
        [0.2363, 0.8951, 0.0335, 0.5779]])</code></pre>
</div>
</div>
</section>
<section id="arithmetic-operations" class="level3" data-number="2.4.4">
<h3 data-number="2.4.4" class="anchored" data-anchor-id="arithmetic-operations"><span class="header-section-number">2.4.4</span> Arithmetic operations</h3>
<p>In PyTorch, you can perform arithmetic operations on tensors in a similar way to how you would perform them on numpy arrays. Lets look at some common arithmetic operations -</p>
<p><strong>Element wise addition</strong></p>
<div class="cell" data-executetime="{&quot;end_time&quot;:&quot;2022-12-26T19:38:04.682966Z&quot;,&quot;start_time&quot;:&quot;2022-12-26T19:38:04.679197Z&quot;}" data-execution_count="10">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>tnsr1 <span class="op">=</span> torch.randn((<span class="dv">3</span>,<span class="dv">4</span>))</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Tensor 1: </span><span class="ch">\n</span><span class="ss">"</span>, tnsr1)</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>tnsr2 <span class="op">=</span> torch.randn((<span class="dv">3</span>,<span class="dv">4</span>))</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss"> Tensor 2: </span><span class="ch">\n</span><span class="ss">"</span>, tnsr2)</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a><span class="co">## Addition</span></span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>tensor_add <span class="op">=</span> tnsr1 <span class="op">+</span> tnsr2 </span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss"> Tensor additions using + : </span><span class="ch">\n</span><span class="ss">"</span>, tensor_add)</span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a>tensor_add <span class="op">=</span> tnsr1.add(tnsr2)</span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss"> Tensor additions using .add : </span><span class="ch">\n</span><span class="ss">"</span>, tensor_add)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Tensor 1: 
 tensor([[-0.4685, -0.7848, -0.4198,  0.0890],
        [ 0.2496,  0.2578,  0.6366, -2.0815],
        [-1.6914, -0.8824,  1.0809,  1.5308]])

 Tensor 2: 
 tensor([[-0.3125,  1.0860,  0.7340,  0.2249],
        [-0.9887,  0.2265, -0.5214, -1.5676],
        [ 0.6817,  0.1099, -0.5298, -0.3109]])

 Tensor additions using + : 
 tensor([[-0.7810,  0.3013,  0.3142,  0.3139],
        [-0.7391,  0.4843,  0.1152, -3.6492],
        [-1.0097, -0.7725,  0.5511,  1.2199]])

 Tensor additions using .add : 
 tensor([[-0.7810,  0.3013,  0.3142,  0.3139],
        [-0.7391,  0.4843,  0.1152, -3.6492],
        [-1.0097, -0.7725,  0.5511,  1.2199]])</code></pre>
</div>
</div>
<p><strong>Element wise subtraction</strong></p>
<div class="cell" data-executetime="{&quot;end_time&quot;:&quot;2022-12-26T19:39:32.241459Z&quot;,&quot;start_time&quot;:&quot;2022-12-26T19:39:32.238300Z&quot;}" data-execution_count="17">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co">## Subtraction</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>tensor_sub <span class="op">=</span> tnsr1 <span class="op">-</span> tnsr2 </span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss"> Tensor subtraction using - : </span><span class="ch">\n</span><span class="ss">"</span>, tensor_sub)</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>tensor_sub <span class="op">=</span> tnsr1.sub(tnsr2)</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss"> Tensor subtraction using .sub : </span><span class="ch">\n</span><span class="ss">"</span>, tensor_sub)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
 Tensor subtraction using - : 
 tensor([[-0.1561, -1.8708, -1.1537, -0.1359],
        [ 1.2384,  0.0313,  1.1580, -0.5139],
        [-2.3732, -0.9923,  1.6107,  1.8417]])

 Tensor subtraction using .sub : 
 tensor([[-0.1561, -1.8708, -1.1537, -0.1359],
        [ 1.2384,  0.0313,  1.1580, -0.5139],
        [-2.3732, -0.9923,  1.6107,  1.8417]])</code></pre>
</div>
</div>
<p><strong>Element wise multiplication</strong></p>
<div class="cell" data-executetime="{&quot;end_time&quot;:&quot;2022-12-26T19:39:25.561507Z&quot;,&quot;start_time&quot;:&quot;2022-12-26T19:39:25.558061Z&quot;}" data-execution_count="16">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co">## Multiplication</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>tensor_mul <span class="op">=</span> tnsr1 <span class="op">*</span> tnsr2 </span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss"> Tensor element-wise multiplication using * : </span><span class="ch">\n</span><span class="ss">"</span>, tensor_mul)</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>tensor_mul <span class="op">=</span> tnsr1.mul(tnsr2)</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss"> Tensor element-wise multiplication using .mul : </span><span class="ch">\n</span><span class="ss">"</span>, tensor_mul)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
 Tensor element-wise multiplication using * : 
 tensor([[ 0.1464, -0.8523, -0.3081,  0.0200],
        [-0.2468,  0.0584, -0.3319,  3.2631],
        [-1.1531, -0.0970, -0.5727, -0.4759]])

 Tensor element-wise multiplication using .mul : 
 tensor([[ 0.1464, -0.8523, -0.3081,  0.0200],
        [-0.2468,  0.0584, -0.3319,  3.2631],
        [-1.1531, -0.0970, -0.5727, -0.4759]])</code></pre>
</div>
</div>
<p><strong>Element wise division</strong></p>
<div class="cell" data-executetime="{&quot;end_time&quot;:&quot;2022-12-26T19:39:14.825458Z&quot;,&quot;start_time&quot;:&quot;2022-12-26T19:39:14.822102Z&quot;}" data-execution_count="15">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co">## Division</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>tensor_div <span class="op">=</span> tnsr1 <span class="op">/</span> tnsr2 </span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss"> Tensor element-wise division using / : </span><span class="ch">\n</span><span class="ss">"</span>, tensor_div)</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>tensor_div <span class="op">=</span> tnsr1.div(tnsr2)</span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss"> Tensor element-wise division using .div : </span><span class="ch">\n</span><span class="ss">"</span>, tensor_div)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
 Tensor element-wise division using + : 
 tensor([[ 1.4994, -0.7226, -0.5719,  0.3958],
        [-0.2525,  1.1381, -1.2209,  1.3278],
        [-2.4811, -8.0272, -2.0401, -4.9238]])

 Tensor element-wise division using .div : 
 tensor([[ 1.4994, -0.7226, -0.5719,  0.3958],
        [-0.2525,  1.1381, -1.2209,  1.3278],
        [-2.4811, -8.0272, -2.0401, -4.9238]])</code></pre>
</div>
</div>
<p><strong>Matrix multiplication</strong></p>
<div class="cell" data-executetime="{&quot;end_time&quot;:&quot;2022-12-26T19:43:42.844471Z&quot;,&quot;start_time&quot;:&quot;2022-12-26T19:43:42.841076Z&quot;}" data-execution_count="21">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>tensor_mm <span class="op">=</span> tnsr1 <span class="op">@</span> tnsr2.T</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss"> Tensor matrix multiplication using @: </span><span class="ch">\n</span><span class="ss">"</span>, tensor_mm)</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>tensor_mm <span class="op">=</span> tnsr1.matmul(tnsr2.T)</span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss"> Tensor matrix multiplication using .matmul: </span><span class="ch">\n</span><span class="ss">"</span>, tensor_mm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
 Tensor matrix multiplication using @: 
 tensor([[-0.9940,  0.3648, -0.2109],
        [ 0.2010,  2.7427,  0.5084],
        [ 0.7078, -1.4908, -2.2987]])

 Tensor matrix multiplication using .matmul: 
 tensor([[-0.9940,  0.3648, -0.2109],
        [ 0.2010,  2.7427,  0.5084],
        [ 0.7078, -1.4908, -2.2987]])</code></pre>
</div>
</div>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Observe that <code>tnsr1</code> and <code>tnsr2</code> have shape (3,4). To perform a matrix multiplication, we used the <code>.T</code> function to transpose <code>tnsr2</code>, which changed its shape to (4,3). The resulting matrix multiplication has size (3x3).</p>
</div>
</div>
<p><strong>Summing it up</strong></p>
<p>Summing tensors along rows and columns is a common operation. Here is the syntax for this operation:</p>
<div class="cell" data-executetime="{&quot;end_time&quot;:&quot;2022-12-26T20:00:29.283615Z&quot;,&quot;start_time&quot;:&quot;2022-12-26T20:00:29.280282Z&quot;}" data-execution_count="32">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Tensor: </span><span class="ch">\n</span><span class="ss"> </span><span class="sc">{</span>tnsr1<span class="sc">}</span><span class="ss">"</span> )</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss"> All up sum: </span><span class="ch">\n</span><span class="ss"> </span><span class="sc">{</span>tnsr1<span class="sc">.</span><span class="bu">sum</span>()<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss"> Column wise sum: </span><span class="ch">\n</span><span class="ss"> </span><span class="sc">{</span>tnsr1<span class="sc">.</span><span class="bu">sum</span>(<span class="dv">0</span>)<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss"> Row wise sum: </span><span class="ch">\n</span><span class="ss"> </span><span class="sc">{</span>tnsr1<span class="sc">.</span><span class="bu">sum</span>(<span class="dv">1</span>)<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Tensor: 
 tensor([[-0.4685, -0.7848, -0.4198,  0.0890],
        [ 0.2496,  0.2578,  0.6366, -2.0815],
        [-1.6914, -0.8824,  1.0809,  1.5308]])

 All up sum: 
 -2.48371958732605

 Column wise sum: 
 tensor([-1.9103, -1.4094,  1.2977, -0.4617])

 Row wise sum: 
 tensor([-1.5841, -0.9375,  0.0378])</code></pre>
</div>
</div>
</section>
</section>
<section id="references" class="level2" data-number="2.5">
<h2 data-number="2.5" class="anchored" data-anchor-id="references"><span class="header-section-number">2.5</span> References</h2>
<ul>
<li><a href="https://pytorch.org/tutorials/beginner/basics/tensorqs_tutorial.html">Pytorch tensors tutorial documentation</a>.</li>
</ul>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  let localAlternateSentinel = 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../basics/0_pytorch_intro.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">PyTorch Introduction and Installation</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">The PyTorch book. Copyright (c) 2022 Aayush Agrawal.</div>   
    <div class="nav-footer-right">This book was built with <a href="https://quarto.org/">Quarto</a></div>
  </div>
</footer>



</body></html>